title: Save Gradle configuration cache
summary: Caches the Gradle configuration cache folder used by Gradle. Uses the Bitrise Build Cache infrastructure.
description: |
  This steps caches the Gradle configuration cache folder and the related metadata required to speed up subsequent builds. The cache is stored in the Bitrise Build Cache infrastructure.

  More info about how the configuration caching works can be found [here](https://docs.gradle.org/current/userguide/configuration_cache.html).

  If not specified otherwise, the current directory is assumed to be the project dir, and thus the `./gradle/configuration-cache` directory is saved.

  IMPORTANT NOTES:
  - You need to have an activate Bitrise Build Cache Trial or Subscription for your workspace to use this step.
  - You also have to set up the encryption key `GRADLE_ENCRYPTION_KEY` in the Bitrise Secrets with the result of running `openssl rand -base64 16`.
  - Setting the encryption key is only supported from Gradle 8.6, so your project must have Gradle 8.6 or higher.
website: https://github.com/bitrise-steplib/bitrise-step-save-gradle-configuration-cache
source_code_url: https://github.com/bitrise-steplib/bitrise-step-save-gradle-configuration-cache
support_url: https://github.com/bitrise-steplib/bitrise-step-save-gradle-configuration-cache

project_type_tags:
- android
- react-native
- flutter

type_tags:
- utility

run_if: .IsCI
is_skippable: true

toolkit:
  bash:
    entry_file: step.sh

deps:
  brew:
  - name: zstd

inputs:
- key_override:
  opts:
    title: Cache key override
    summary: Override key used for saving the cache. By default the app slug and branch is used
    description: |-
      Manually provided override key used for saving the cache.
     
      If not specified, by default a key is generated from the app slug and the current branch. If not specified, the contents are also saved to a fallback key consisting only of the app slug. This helps reduce cache misses on new feature branches.
    is_required: false
- config_cache_dir: ./.gradle/configuration-cache
  opts:
    title: Configuration cache directory
    summary: Path to the configuration cache folder
    description: |-
      This needs to be set to the config cache folder generated by Gradle. It's usually in the project and NOT in the Gradle home.
    is_required: true

- verbose: "false"
  opts:
    title: Verbose logging
    summary: Enable logging additional information for troubleshooting
    is_required: true
    value_options:
    - "true"
    - "false"
